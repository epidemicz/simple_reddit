<html>                                                                  
  <head>         
    <style>
      #divpopup{
        position: fixed;
        top: 25px;
        left: 0px;
        border: 1px solid #000;
        background-color: black;
        color: white;
        padding: 5px;
        z-index: 10;
      }
      #header{
        position: fixed;
        top: 0px;
        left: 0px;
        width:100%;
        background-color: white;
        padding: 5px;
        z-index: 10;
      }
    </style>
    <script type="text/javascript" src="jquery.js"></script>          
    <script type="text/javascript" src="endless-scroll.js"></script>   
    <script type="text/javascript">     
      var after = "";
      var count = 0;
      var sort = "hot";
      
      // we will add our javascript code here
      function fetch_reddit_links(cnt, after, sort){
        var query;
        var l = document.getElementById("links");
        if (after == null) {
          query = "http://www.reddit.com/" + sort + ".json?jsonp=?&limit=100";
        }
        else {
          query = "http://www.reddit.com/" + sort + ".json?jsonp=?&limit=100&after=" + after
        }
        
        $.getJSON(query, function(data) { 
          after = data.data.after;
          $.each(data.data.children, function(i, item){
            var sub_color = false;
            count = count + 1;
            
            // if nsfw flag set, make subreddit color red
            if ( item.data.over_18 == true )
              sub_color = "red";
            else
              sub_color = "black";1
            newLink = document.createElement("span");
            newLink.innerHTML = count + ".) " + "<span style=\"color:" + sub_color + "\">[" + item.data.subreddit + "]</span> <a target=\"_blank\" href=\"" + item.data.url + "\">" + item.data.title + "</a> [<a target=\"_blank\" href=\"http://reddit.com" + item.data.permalink + "\">comments</a>]<br/>";
            l.appendChild(newLink);
          });
        });
      } 
        
      $(document).ready(function() {
        // do stuff when DOM is ready
        $("#blah").click(function() {
          alert("after=" + after + " count = " + count);
        });

        $("#hot").click(function() {
          count = 0;
          sort = "hot";
          document.getElementById("links").innerHTML = "";
          fetch_reddit_links(count, null, sort);
        });
        
        $("#new").click(function() {
          count = 0;
          sort = "new";
          document.getElementById("links").innerHTML = "";
          fetch_reddit_links(count, null, sort);
        });
        
        $("#top").click(function() {
          count = 0;
          sort = "top";
          document.getElementById("links").innerHTML = "";
          fetch_reddit_links(count, null, sort);
        });

        $(document).endlessScroll({
          bottomPixels:300,
          fireOnce: true,
          fireDelay: 5000,
          loader:"<div id=\"divpopup\">Loading... Please wait..</div>",
          callback:function(p) {
            fetch_reddit_links(count, after, sort);
          }
        });
      });                                    
    </script>                                                               
  </head>                                                                 
  <body>                                                                  
    <!-- we will add our HTML content here -->     
    <div id="header"><a href="#" id="hot">Hot</a> | <a href="#" id="new">New</a> | <a href="#" id="top">Top</a></div>
    <div id="links" style="padding-top:20px;"></div>
  </body>                                                       
</html>